<!DOCTYPE html>
<html>
<head>
<title>Grocery Shop - Admin</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>
body{margin:0;font-family:Arial;background:#f5f5f5;}
.header{background:#e60000;color:white;padding:15px;display:flex;justify-content:space-between;align-items:center;}
.main{padding:20px;}
input, select{padding:6px;margin:5px;}
button{padding:6px 10px;margin:5px;background:#ffcc00;border:none;cursor:pointer;}
.products{display:grid;grid-template-columns:repeat(auto-fit,minmax(180px,1fr));gap:20px;}
.card{background:white;padding:10px;text-align:center;border-radius:8px;}
.card img{width:100%;height:120px;object-fit:cover;}
</style>
</head>
<body>

<div class="header"><h2>Admin Panel - Grocery Shop</h2></div>

<div class="main">
    <h3>Add Product</h3>
    <input type="text" id="productName" placeholder="Product Name">
    <input type="text" id="productCategory" placeholder="Category">
    <input type="file" id="productImage">
    <button onclick="addProduct()">Add Product</button>

    <h3>Existing Products</h3>
    <div class="products" id="adminProductList"></div>
</div>

<!-- Firebase -->
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-storage-compat.js"></script>

<script>
const firebaseConfig = {
  apiKey: "AIzaSyCkYMVn0Jh4Oo8Mgm8WyVAOVe65lSLGeks",
  authDomain: "barrahms-app.firebaseapp.com",
  projectId: "barrahms-app",
  storageBucket: "barrahms-app.firebasestorage.app",
  messagingSenderId: "886499355529",
  appId: "1:886499355529:web:051977ab95fdc3d9b5cf58",
  measurementId: "G-34HG0VVZFY"
};

// Initialize Firebase
const app = initializeApp(firebaseConfig);
const analytics = getAnalytics(app);

// Load Products
function loadProducts(){
    const adminList=document.getElementById("adminProductList");
    adminList.innerHTML='';
    db.collection("products").get().then(snapshot=>{
        snapshot.forEach(doc=>{
            let data=doc.data();
            let card=document.createElement("div");
            card.className="card";
            card.innerHTML=`<img src="${data.imageURL}"><h4>${data.name}</h4>
            <button onclick="deleteProduct('${doc.id}')">Delete</button>`;
            adminList.appendChild(card);
        });
    });
}
loadProducts();

// Add Product
function addProduct(){
    let name=document.getElementById("productName").value;
    let category=document.getElementById("productCategory").value;
    let file=document.getElementById("productImage").files[0];
    if(!name||!category||!file){alert("All fields required!");return;}
    let ref=storage.ref('products/'+file.name);
    ref.put(file).then(snap=>{
        snap.ref.getDownloadURL().then(url=>{
            db.collection("products").add({name,category,imageURL:url}).then(()=>{
                alert("Product added!");loadProducts();
            });
        });
    });
}

// Delete Product
function deleteProduct(id){db.collection("products").doc(id).delete().then(()=>{loadProducts();});}
</script>
</body>
</html>
